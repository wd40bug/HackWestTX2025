@page "/"
@using System.Runtime.InteropServices
@rendermode InteractiveServer

<PageTitle>LOVE-ME-NOT</PageTitle>

<h1 class="titan-one title">LOVE-ME-NOT</h1>

@switch (state)
{
    case Page.UploadFile:
        <UploadFile OnLove="@LoveCalculated" />
        ; break;
    case Page.Loading:
        <Loading />
        ; break;
    case Page.Results:
        <Results />
        ; break;
}


@code {
    enum Page
    {
        UploadFile,
        Loading,
        Results,
    }
    Page state = Page.UploadFile;
    private List<Message> parse_json = new List<Message>();

    public async void LoveCalculated((IBrowserFile file, string token) args)
    {
        Console.WriteLine("Love calculated");
        state = Page.Loading;
        await InvokeAsync(StateHasChanged);
        parse_json = await FileHandle.ParseJson(args.file, args.token);
        Console.WriteLine("Number of messages: " + parse_json.Count());
        foreach (var message in parse_json)
        {
            Console.Write(message.Time + ": ");
            Console.WriteLine(message.Content);
        }
        ChatLog clog = new ChatLog(parse_json);
        clog.FindAverageResponseTime();
        state = Page.Results;
        await InvokeAsync(StateHasChanged);
        Console.WriteLine("Finished Calculating Love!!!");
    }
}

<style>
    .title {
        font-size: 100pt;
        color:
            @BlazorTest.ColorConstants.rose
        ;
    }

    body {
        background-color:
            @BlazorTest.ColorConstants.mint
        ;
        display: flex;
        justify-content: center;
    }
</style>